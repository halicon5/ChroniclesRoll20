<script type="text/worker">
    var testObj = [];
    on("change:repeating_profs", function(e) {
        var profid = getIdFromProfsEvent(e);
        getSectionIDs("repeating_profs", function(idarray) {
            var attrsList = [];
            attrsList.push("repeating_profs_" + profid + "_prof-name");
            attrsList.push("repeating_profs_" + profid + "_prof-rank");
            attrsList.push("repeating_profs_" + profid + "_prof-rankmod");
            attrsList.push("repeating_profs_" + profid + "_prof-tohit");
            attrsList.push("repeating_profs_" + profid + "_prof-dam");
            attrsList.push("repeating_profs_" + profid + "_prof-tohit");
            attrsList.push("repeating_profs_" + profid + "_prof-crit");

            getAttrs(attrsList, function(v){
                console.log(attrsList);
                console.log(v);
            });
        });
    });


    function getIdFromProfsEvent(e) {
        if (e.sourceAttribute && e.sourceAttribute.replace) {
            var profid = e.sourceAttribute.replace("repeating_profs_","");
            var profid = profid.replace("_prof-rank","");
            var profid = profid.replace("_prof-rankmod","");
            var profid = profid.replace("_prof-tohit","");
            var profid = profid.replace("_prof-dam","");
            var profid = profid.replace("_prof-crit","");
            return profid;
        }
    }
</script>

<div class="tab">Char Info</div><input class="charpanel" type="checkbox" name="attr_charpanel" value="charpanel" />
<div class="tab">Skills Info</div><input class="skpanel" type="checkbox" name="attr_skpanel" value="skpanel" />
<div class="tab">Combat Info</div><input class="combatpanel" type="checkbox" name="attr_combatpanel" value="combatpanel" />
<div class="tab">Inventory</div><input class="inventorypanel" type="checkbox" name="attr_inventorypanel" value="inventorypanel" />
<div class="tab">Bio</div><input class="biopanel" type="checkbox" name="attr_biopanel" value="biopanel" />

<div class="panel charpanel">The Character Info Panel</div>

<div class="panel skpanel">The Character Skills Panel</div>

<div class="panel combatpanel">The Combat Panel</div>    

<div class="panel inventorypanel">The Inventory Panel</div>    

<div class="panel biopanel">The Bio Panel</div>    

<h4>Combat Items</h4>
<fieldset class="repeating_combacts">
    <input type="text" name="attr_combact-name">
    Linked Prof: <select name="attr_combact-prof">
        <option value="">-- None --</option>
        <option value="archery">Archery</option>
        <option value="armor">Armor</option>
        <option value="dualweapon">Dual Weapon Fighting</option>
        <option value="greatswords">Great Swords</option>
        <option value="handguns">Handguns</option>
        <option value="heavyweapons">Heavy Weapons</option>
        <option value="hooked">Hooked Weapons</option>
        <option value="lightweapons">Light Weapons</option>
        <option value="polearms">Polearms</option>
        <option value="rifleandcrossbow">Rifle and Crossbow</option> 
        <option value="shields">Shields</option>
        <option value="shouspiritway">Shou Spirit Way</option>
        <option value="smallblades">Small Blades</option>
        <option value="thrownweapons">Thrown Weapons</option>
        <option value="unarmed">Unarmed Combat</option>
        <option value="wrestling">Wrestling</option>
    </select>
    <select name="attr_combact-coreskill">
        <option value="">-- Type --</option>
        <option value="melee">Melee</option>
        <option value="aim">Aim</option>
    </select>
    <input type="text" class="combtxt" name="attr_combact-tohit">
</fieldset>


<h4>Proficiencies</h4>
<fieldset class="repeating_profs">
    <select name="attr_prof-name">
        <option value="archery">Archery</option>
        <option value="armor">Armor</option>
        <option value="dualweapon">Dual Weapon Fighting</option>
        <option value="greatswords">Great Swords</option>
        <option value="handguns">Handguns</option>
        <option value="heavyweapons">Heavy Weapons</option>
        <option value="hooked">Hooked Weapons</option>
        <option value="lightweapons">Light Weapons</option>
        <option value="polearms">Polearms</option>
        <option value="rifleandcrossbow">Rifle and Crossbow</option> 
        <option value="shields">Shields</option>
        <option value="shouspiritway">Shou Spirit Way</option>
        <option value="smallblades">Small Blades</option>
        <option value="thrownweapons">Thrown Weapons</option>
        <option value="unarmed">Unarmed Combat</option>
        <option value="wrestling">Wrestling</option>
    </select>
    <input class="proftxt" type="text" name="attr_prof-rank"/>
    <input class="proftxt" type="text" name="attr_prof-rankmod" />
    <input class="proftxt" type="text" name="attr_prof-tohit" />
    <input class="proftxt" type="text" name="attr_prof-dam" />
    <input class="proftxt" type="text" name="attr_prof-crit" />
</fieldset>